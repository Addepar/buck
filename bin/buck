#!/bin/bash

PYTHON=$(command -v python2 python | head -1)

# Resolve symlinks if necessary. 'readlink -f' and 'realpath' unfortunately
# do not work on macOS, so we have to resort to using Python.
BUCK_PATH=$($PYTHON -c 'import os, sys; print (os.path.realpath(sys.argv[1]))' "$0")
BUCK_DIR=$(dirname "$BUCK_PATH")

PYTHONPATH="$BUCK_DIR"/../third-party/nailgun exec $PYTHON "$BUCK_DIR"/../programs/buck.py "$@"
